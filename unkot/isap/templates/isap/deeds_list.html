{% extends 'base.html' %}

{% block title %}Wykaz aktów{% endblock %}


{% block content %}

<div class="mb-3" id="deeds-list">
  <form action="?page=1" method="post" up-submit>
    {% csrf_token %}

    <div class="row">
      <div class="col">
        <input id="query" class="form-control" type="search" name="query" value="{{ query|default:"" }}">
      </div>
    </div> 
    <div class="row">
      <div class="col">
        <input class="btn btn-primary form-control" type="submit" value="Szukaj" name="search button">
      </div>
      {% if request.user.is_authenticated %}
      <div class="col">
        <input class="btn btn-primary form-control" type="submit" value="Zapisz wyszukiwanie" name="save search button">
      </div>
      {% endif %}
    </div>
  </form>

  {% if request.user.is_authenticated %}
  {% if saved_searches_count %}
  <p>Masz {{ saved_searches_count }} <a href="{% url 'saved_isap_searches' %}">zapisanych wyszukiwań</a>.</p>
  {% else %}
  <p>Nie masz zapisanych żadnych wyszukiwań.</p>
  {% endif %}
  {% endif %}

  {% if not request.user.is_authenticated %}
  <p>Założenie konta i zalogowanie się umożliwia korzystanie z pełnej funkcjonalności serwisu.</p>
  {% endif %}

  <p>
  <b>{{ deeds_count_all }}</b> aktów w bazie{% if query %},
  <b>{{ deeds_count_query }}</b> aktów spełniających warunki wyszukiwania
  {% endif %}
  </p>


  {% if page_obj %}

  {% include 'isap/pagination.html' %}

  <table class="table table-striped table-condensed">
    <thead>
      <tr>
        <th scope="col">Tytuł</th>
        <th scope="col">Status</th>
        <th scope="col">Zmiana</th>
      </tr>
    </thead>
    <tbody>
      {% for deed in deeds %}
      <tr>
        <td><a href="{% url 'deed_detail' deed.address %}">{{ deed.title }}</a></td>
        <td>{{ deed.status }}</td>
        <td>{{ deed.change_date }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p>Brak aktów do wyświetlenia.</p>
  {% endif %}
</div>

</div>
{% include 'isap/attribution_isap.html' %}

{% endblock %}
